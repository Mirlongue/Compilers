# 2 一个简单的语法制导翻译器



## 2.1 引言

语法（syntax）：该语言的程序的正确形式

语义（semantics）：程序的含义，每个程序在运行时做什么事情

词法单元（token）：如标识符

抽象语法树（abstract syntax tree）：简称语法树（syntax tree）表示原程序的层次化语法结构

## 2.2 语法定义

文法自然地描述了大多数程序设计语言构造的层次化语法树

`stmt` → **if** (`expr`) `stmt` **else** `stmt`

`stmt`：语句

`expr`：表达式

→读作具有如下形式，这样的规则称为产生式（production）

关键字**if**和括号这样的词法元素为终结符号（terminal）

`stmt`和`expr`这样的变量称为非终结符号（nonterminal）

### 2.2.1 文法定义

上下文无关文法（context-free grammar）由四个元素组成

​	1 终结符号集合，也被称为词法单元，终结符号是该文法所定义的语言的基本符号的集合

​	2 非终结符号集合，也被称为语法变量，每个非终结符号表示一个终结符号串的集合

​	3 产生式集合，每个产生式包括一个称为产生式头或左部的非终结符号一个箭头和一个称为产生式体或右部	的由终结符号及非终结符号组成的序列

​	4 指定一个非终结符号为开始符号

词法单元由两个部分组成，名字，属性值。名字是语法分析器进行语法分析时使用的抽象符号，通常被称为终结符号

例2.1：

*list*→*list* + *digit*

*list*→*list* - *digit*

*list*→*digit*

*digit*→0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9

非终结符号是*list*和*digit*，*list*为此文法的开始符号

零个终结符号组成的串为空串（empty string）

### 2.2.2 推导

从开始符号推导得到的所有终结符号串的集合称为该文法定义的语言（language）

例2.3  函数调用中参数列表，这样的序列构造具有如下生产式的文法：

*call*→**id**(*optparams*)

*optparams*→*params* | null

*params*→*params*, *param* | *param*

语法分析（parsing）的任务：接受一个终结符号串作为输入，找出从文法开始符号推导出这个串的方法，若不能则报告该终结符号串中包含的语法错误

一般情况下，一个源程序中包含由多个字符组成的词素，词素由词法分析器组成词法单元，词法单元的第一个分量就是被语法分析器处理的终结符号

### 2.2.3 语法分析树

语法分析树用图形方式展现了从文法的开始符号推导出相应语言中的符号串的过程

给定一个上下文无关文法，该文法的一颗语法分析树（parse tree）是具有以下性质的树

根结点的标号为文法的开始符号

每个叶子节点的标号为一个终结符号或null

每个内部节点的标号为一个非终结符号

若非终结符号A是内部节点标号，如果A→null是一个产生式，A可以只有一个标号为null的子节点

一颗语法分析树的叶子节点从左向右构成了树的结果（yield）

一个文法的语言的另一个定义是指任何能够由某棵语法分析树生产的符号串的集合。为一个给定的终结符号串构建一颗语法分析树的过程称为对该符号串进行语法分析

### 2.2.4 二义性

一个文法可能有多颗语法分析树能够生成同一个给定的终结符号串，这样的文法称为具有二义性（ambiguous）

例2.5：

*string*→*string* + *string* | *string* - *string* | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9

在生成 9-5+2时会生成多颗语法分析树 如 (9-5)+2，9-(5+2)

### 2.2.5 运算符的结合性













